<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/templates/modelo.xhtml">


	<style type="text/css">
.ui-panelgrid.showcase-text-align-center .ui-grid-responsive .ui-panelgrid-cell
	{
	text-align: center;
}

.customPanelGrid .ui-panelgrid-content {
	align-items: center;
}

.left {
	text-align: left;
}

.center {
	text-align: center;
}

.right {
	text-align: right;
}

.buttonPanel {
	text-align: center;
	width: 80%;
	margin: 0px auto;
}
</style>

	<ui:define name="conteudo">

		<h:outputStylesheet name="primeicons/primeicons.css"
			library="primefaces" />

		<p:panel header="Cadastro">
			<h:form id="dadosForm">








				<p:panelGrid id="dadosForm" columns="2" layout="tabular"
					style="margin: 0 auto;" styleClass="ui-noborder">


					<i class="pi pi-users"></i>
					<b style="color: #518e2e; margin: 0 auto;">IDENTIFICAÇÃO</b>

					<h:outputText value="" />


					<p:outputLabel value="CNPJ: " />
					<p:inputText id="cnpj" maxlength="14" size="50"
						placeholder="Digite o CNPJ"
						value="#{empresaTerceirizadaBean.pessoaJuridica.cnpj}"
						required="true" requiredMessage="O campo CNPJ é obrigatório">
						<p:ajax event="blur"
							listener="#{empresaTerceirizadaBean.buscarCNPJ}"
							update="dadosForm:razaoSocial, dadosForm:nomeFantasia, dadosForm:telemp, dadosForm:celemp, dadosForm:emailemp, dadosForm:cep_endereco, dadosForm:endereco, dadosForm:complemento, dadosForm:estado, dadosForm:cidade" />
						<f:validator validatorId="ValidatorCNPJ" />
					</p:inputText>


					<p:outputLabel value="Razão Social:" />
					<p:inputText maxlength="50" size="30" id="razaoSocial"
						value="#{empresaTerceirizadaBean.pessoaJuridica.razaoSocial}" required="true"
						requiredMessage="O campo Razão Social é obrigatório"
						style="text-transform:uppercase;" />

					<p:outputLabel value="Nome Fantasia:" />
					<p:inputText maxlength="50" size="30" id="nomeFantasia"
						value="#{empresaTerceirizadaBean.pessoaJuridica.nomeFantasia}"
						style="text-transform:uppercase;" />

					<p:outputLabel value="Telefone Empresa:" />
					<p:inputMask id="telemp" mask="(99) 9999-9999" maxlength="11"
						size="11" value="#{empresaTerceirizadaBean.pessoaJuridica.telEmp}"
						required="true" requiredMessage="O campo Telefone é obrigatório">
					</p:inputMask>

					<p:outputLabel value="Celular Empresa:" />
					<p:inputMask id="celemp" mask="(99) 99999-9999" maxlength="11"
						size="11" value="#{empresaTerceirizadaBean.pessoaJuridica.celEmp}"
						required="true" requiredMessage="O campo Celular é obrigatório">
					</p:inputMask>

					<p:outputLabel value="E-mail Empresa:" />
					<p:inputText maxlength="50" size="30" id="emailemp"
						value="#{empresaTerceirizadaBean.pessoaJuridica.email}" required="true"
						requiredMessage="O campo Telefone é obrigatório"
						style="text-transform:uppercase;" />





					<br />
					<br />
					<i class="pi pi-globe"></i>
					<b style="color: #518e2e; margin: 0 auto;">ENDEREÇO</b>

					<h:outputText value="" />


					<p:outputLabel value="CEP:" />
					<p:inputMask id="cep_endereco" mask="99.999-999" maxlength="11"
						size="11" value="#{empresaTerceirizadaBean.pessoaJuridica.cep}"
						required="true" requiredMessage="O campo CEP é obrigatório">
					</p:inputMask>

					<p:outputLabel value="Endereço: " />
					<p:inputText maxlength="50" size="30" id="endereco"
						value="#{empresaTerceirizadaBean.pessoaJuridica.endereco}" required="true"
						requiredMessage="O campo Endereço Residência é obrigatório"
						style="text-transform:uppercase;" />

					<p:outputLabel value="Complemento:" />
					<p:inputText maxlength="50" size="30" id="complemento"
						value="#{empresaTerceirizadaBean.pessoaJuridica.complemento}"
						style="text-transform:uppercase;" />

					<p:outputLabel for="estado" value="UF: " />
					<p:selectOneMenu id="estado" filter="true"
						converter="omnifaces.SelectItemsConverter"
						value="#{empresaTerceirizadaBean.pessoaJuridica.estadoEndereco}">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione um estado" />
						<f:selectItems value="#{empresaTerceirizadaBean.estados}" var="estado"
							itemValue="#{estado}" itemLabel="#{estado.sigla}" />
						<p:ajax listener="#{empresaTerceirizadaBean.popular}"
							update=":dadosForm:cidade" />
					</p:selectOneMenu>

					<p:outputLabel for="cidade" value="Municipio" />
					<p:selectOneMenu id="cidade" filter="true" required="true"
						requiredMessage="O campo Municipio é obrigatório"
						converter="omnifaces.SelectItemsConverter"
						value="#{empresaTerceirizadaBean.pessoaJuridica.municipioEndereco}">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione uma cidade" />
						<f:selectItems value="#{empresaTerceirizadaBean.cidades}" var="cidade"
							itemValue="#{cidade}" itemLabel="#{cidade.nome}" />
					</p:selectOneMenu>







				</p:panelGrid>


				<br />
				<br />











				<h:panelGrid columns="2" style="margin: 0 auto;">
					<p:commandButton value="Salvar" style="background: #01B50D"
						actionListener="#{empresaTerceirizadaBean.salvar()}"
						update=":mensagem :formlista:lista" />

					<p:commandButton value="Limpar"
						actionListener="#{empresaTerceirizadaBean.listar()}"
						update=":mensagem :formlista:lista" />

				</h:panelGrid>
			</h:form>

		</p:panel>



		<h:form id="formlista"
			rendered="#{autenticacaoBean.temPermissoes([1, 13])}">
			<p:panel header="Empresas - Listagem">
				<p:dataTable id="lista" emptyMessage="Nenhum registro encontrado."
					paginator="true"
					value="#{empresaTerceirizadaBean.listaEmpresasTerceirizadas}"
					var="empresa" rows="10">
					
					<p:column headerText="CNPJ"
						sortBy="#{empresa.pessoaJuridica.cnpj}"
						filterBy="#{empresa.pessoaJuridica.cnpj}"
						style="width: 70px; text-align: center;">
						<h:outputText value="#{empresa.pessoaJuridica.cnpj}" />
					</p:column>
					
					<p:column headerText="Razão Social"
						sortBy="#{empresa.pessoaJuridica.razaoSocial}"
						filterBy="#{empresa.pessoaJuridica.razaoSocial}"
						style="width: 70px; text-align: center;">
						<h:outputText value="#{empresa.pessoaJuridica.razaoSocial}" />
					</p:column>
					


					<p:column headerText="Nome Fantasia"
						sortBy="#{empresa.pessoaJuridica.nomeFantasia}"
						filterBy="#{empresa.pessoaJuridica.nomeFantasia}"
						style="width: 70px; text-align: center;">
						<h:outputText value="#{empresa.pessoaJuridica.nomeFantasia.toUpperCase()}" />
					</p:column>
					

					<p:column headerText="Opções"
						style="width: 70px; text-align: center;">
						<p:commandButton icon="ui-icon-trash"
							actionListener="#{empresaTerceirizadaBean.excluir}"
							update=":mensagem :formlista:lista">
							<p:confirm header="Confirmação"
								message="Deseja excluir a Empresa?" icon="ui-icon-alert" />
							<f:attribute name="empresaSelecionada" value="#{empresa}" />
						</p:commandButton>

						<p:commandButton icon="ui-icon-pencil"
							actionListener="#{empresaTerceirizadaBean.editar}"
							update=":dadosForm">
							<f:attribute name="empresaSelecionada" value="#{empresa}" />
							<f:actionListener
								type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
						</p:commandButton>

					</p:column>
				</p:dataTable>

				<p:confirmDialog global="true">
					<p:commandButton value="Sim" type="button"
						styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
					<p:commandButton value="Não" type="button"
						styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
				</p:confirmDialog>
			</p:panel>
		</h:form>

	</ui:define>
</ui:composition>
